<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Manage Groups</title>
        <link href="manageGroup.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="manageGroup.js">//</script>
    </head>
    <body class="manageModulePages">
        <!-- Content goes here - NO HEADER/BANNER/MENU! -->
        <section id="manageGroup" class="MainContent">
            <header class="ClearFix">
                <button class="SmallBtn Add AddGroup"><span>Add New Group</span></button>
            </header>
            #foreach($group in $page.children)
            <div class="Group">
                <header class="ClearFix">
                    <div class="ShowDialog"><span>$group.name</span></div>
                    <a class="numMembers" href="$group.name/members">$group.numMembers Members</a>
                    <a href="#" class="regoMode">Registration: $group.regoModeText</a>
                </header>
                <div class="ContentGroup ClearFix">
                    #portlets("groupDetails")
                    <h4>Roles</h4>
                    <ul class="PermissionList ClearFix">
                        #foreach($role in $group.children)
                        <li>
                            <span>$role.title</span>
                            <a href="$role.href">Delete</a>
                        </li>
                        #end
                    </ul>	
                    <div class="ClearFix">
                        <button onclick="showPermissionModal(this)" class="SmallBtn Add AddPermission"><span>Add roles</span></button>
                    </div>                    
                </div>
            </div>
            #end
        </section>

        <div class="Modal roles">
            <header>
                <h3>Edit roles</h3>
                <a class="Close" href="#" title="Close"><span class="Hidden">Close</span></a>
            </header>

            <div class="ModalContent">
                <table>
                    <tr>
                        <td colspan="2">
                            <p>Role applies to:</p>
                            <ul class="appliesTo">
                                <li>
                                    <input type="radio" name="appliesTo" value="ownOrg" id="appliesToOwnOrg" /> 
                                    <label for="appliesToOwnOrg">Their own organistion</label>
                                </li>
                                <li>
                                    <input type="radio" name="appliesTo" value="selectRepo" id="appliesToRepository"/> 
                                    <label for="appliesToRepository">A repository</label>
                                    <select>
                                        <option value="">-- Select a repository --</option>
                                        #foreach($r in $page.organisation.repositories)
                                        <option value="$r.name">$r.name</option>
                                        #end
                                    </select>
                                </li>
                                <li>
                                    <input type="radio" name="appliesTo" value="selectOrg" id="appliesToOrg"/> 
                                    <label for="appliesToOrg">An organistion</label>
                                    <select>
                                        <option value="">-- Select an organisation --</option>
                                        <option value="$page.organisation.orgId">$page.organisation.formattedName (this organisation)</option>
                                        #foreach($org in $page.organisation.childOrgs)
                                        <option value="$org.orgId">$org.formattedName</option>
                                        #end
                                    </select>

                                </li>
                            </ul>
                            <ul class="ListItem roles">
                                #foreach($role in $page.allRoles)
                                <li>
                                    <span>$role</span>
                                    <aside>
                                        <button class="SmallBtn Add"><span>Add role</span></button>
                                    </aside>
                                </li>
                                #end
                            </ul>
                        </td>
                    </tr>
                </table>
            </div>                    
        </div>        

        <div class="Hidden">
            <div id="dialogGroup">
                <div class="Dialog Hidden">
                    <a href="" class="RenameGroup">Rename this group</a>
                    <a href="" class="Delete DeleteGroup">Delete this group</a>
                    <a href="" class="ViewGroupMembers">View members</a>
                    <a href="" class="CopyMembers">Copy members from other group</a>
                </div>
            </div>
            <div id="modalListController">
                <aside>
                    <label for="selected"><input type="checkbox" value="1" id="selected" name="selected" class="FuseChk" checked="checked" /></label>
                </aside>
            </div>
        </div>

        <div id="modalGroup" class="Modal">
            <header>
                <h3>Edit Group</h3>
                <a class="Close" href="#" title="Close"><span class="Hidden">Close</span></a>
            </header>
            <div class="ModalContent">
                <table>
                    <tr rel="Group" class="Hidden">
                        <th><label for="name">Group name</label></th>
                        <td><input type="text" name="name" id="name" value="" placeholder="Group name" /></td>
                    </tr>                    
                    <tr>
                        <td colspan="2" class="Btn">
                            <button>Save changes</button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="modalRegoMode" class="Modal">
            <header>
                <h3>Registration Mode</h3>
                <a class="Close" href="#" title="Close"><span class="Hidden">Close</span></a>
            </header>
            <div class="ModalContent">
                <form method="POST" action="">
                    <div class="BtnBar">
                        <button class="Btn">Save</button>
                        <div style="clear: both"></div>
                    </div>
                    <table>
                        <tr>
                            <td><input type="radio" name="regoMode" id="regoModeOpen" value="o"/><label for="regoModeOpen">Open</label></td>
                            <td>Allows any member of the public to register and their membership is immediately active</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="regoMode" id="regoModeAdmin" value="a"/><label for="regoModeAdmin">Admin-review</label></td>
                            <td>Allows any member of the public to register but the membership is initially inactive until reviewed by an administrator</td>
                        </tr>
                        <tr>
                            <td><input type="radio" name="regoMode" id="regoModeClosed" value="c"/><label for="regoModeClosed">Closed</label></td>
                            <td>External registration is not available. Instead administrators create accounts as required</td>
                        </tr>
                        <tr>
                            <td><label for="selectOrgLabel">Organisation Type</label></td>
                            <td>
                                <select name="orgType">
                                    <option value="">[Any]</option>
                                    #foreach($ot in $page.organisation.orgTypes)
                                    <option value="$ot.name">$ot.displayName</option>
                                    #end
                                </select> 
                                <p>Select which type of organisation to allow users to register to.</p>
                            </td>
                        </tr>
                        <tr>
                            <td><label for="rootOrg">Select from</label></td>
                            <td>
                                <select name="sRootRegoOrg">
                                    <option value="">$page.organisation.formattedName (this organisation)</option>
                                    #foreach($org in $page.organisation.childOrgs())
                                    <option value="$org.orgId">$org.formattedName</option>
                                    #end
                                </select>                            
                                <p>Enter the business unit which users will search within for thier organisation. Eg asia, or asia/southeast</p>                                                    
                            </td>
                        </tr>
                    </table>
                </form>
            </div>

        </div>

        <div id="modalCopyMembers" class="Modal">
            <header>
                <h3>Copy Members To: <span>.</span></h3>
                <a class="Close" href="#" title="Close"><span class="Hidden">Close</span></a>
            </header>
            <div class="ModalContent">
                <form method="POST" action="">
                    <div class="BtnBar">
                        <button class="Btn">Copy Members</button>
                        <div style="clear: both"></div>
                    </div>
                    <p>Use this form to copy the members from the group below into <span>.</span><br/><br/></p>
                    <table>
                        <tr>
                            <td><label for="selectSourceGroup"><b>Group</b></label></td>
                            <td>
                                <select name="sourceGroup">
                                    <option value="">[None]</option>
                                    #foreach($group in $page.organisation.groups)
                                    <option value="$group.name">$group.name</option>
                                    #end
                                </select> 
                                <p>Select the group to copy members from.</p>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>

        </div>        

        <script type="text/javascript" >
            jQuery(function() {
                initManageGroup();
            });
        </script>        
    </body>
</html>