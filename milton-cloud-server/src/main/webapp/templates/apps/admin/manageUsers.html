<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>$view.title</title>
        <link rel="stylesheet" type="text/css" href="manageUser.css" />
        <script type="text/javascript" src="manageUser.js">//</script>
    </head>
    <body class="manageUserPages">
        <section id="manageUser" class="MainContent">
            <header class="ClearFix">
                <a href="new" class="SmallBtn Add newUser"><span>Add New User</span></a>
            </header>            
            <div class="Info">
                <header class="ClearFix">
                    <div class="SearchBox">
                        <input id="userQuery" type="text" value="" placeholder="Search for user here" />
                        <a href="#" class="ClearText"><span class="Hidden">X</span></a>
                    </div>
                    <!--
                    <div class="Setting">
                        <a href="#" title="Setting"><span class="Hidden">Setting</span></a>
                        <div class="SettingContent ClearFix Hidden">
                            <header>
                                Rows shown <select name="row"><option value="13">13</option></select>
                            </header>
                            <ul>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="fname" checked="checked" name="fname" id="fname" /><label for="fname">First name</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="lname" checked="checked" name="lname" id="lname" /><label for="lname">Last name</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="email" checked="checked" name="email" id="email" /><label for="email">Email address</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="contact" checked="checked" name="contact" id="contact" /><label for="contact">Contact</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="state" checked="checked" name="state" id="state" /><label for="state">State</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="country" name="country" id="country" /><label for="country">Country</label></div></li>
                                <li><div class="CheckBoxWrapper"><input type="checkbox" value="remember" name="remember" id="remember" /><label for="remember">Remember these settings</label></div></li>
                            </ul>
                            <button class="Btn" id="saveChange">SAVE CHANGES</button>
                        </div>
                    </div>
                    -->
                </header>
                <table class="Summary" id="userSearchResults">
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Email Address</th>
                        <th>Contact</th>
                        <th>State</th>
                        <th>&nbsp;</th>
                    </tr>
                    #foreach($p in $page.searchResults)
                    <tr>
                        <td>
                            #if($p.firstName)
                            $p.firstName
                            #else
                            $p.name
                            #end
                        </td>
                        <td>$!p.surName</td>
                        <td>$p.email</td>
                        <td>$!p.phone</td>
                        <td>NSW</td>
                        <td>
                            <div class="Controller">
                                <a title="Show Dialogue" class="ShowDialog" href="#"><span class="Hidden">Show Dialogue</span></a>
                                <div class="Dialog Hidden">
                                    <a href="$p.id">Edit user details</a>
                                    <a href="$p.id">View user details</a>
                                </div>
                            </div>
                        </td>                    
                    </tr>
                    #end
                </table>
            </div>
        </section>

        <div class="Modal newUser">
            <header>
                <h3>New user</h3>
                <a class="Close" href="#" title="Close"><span class="Hidden">Close</span></a>
            </header>                           
            <div class="ModalContent">
                #set($groups = $page.groups)
                #if($groups.isEmpty())
                <p class="validationError">You must create at least one group in this or a parent organisation before you can add users</p>
                #else
                <form method="POST" action="new">
                    <div class="pageMessage"></div>
                    <div class="inputs">
                        <label for="newUserNickName">Nick name</label>
                        <input type="text" name="nickName" id="newUserNickName" class="required" />
                        <label for="newUserEmail">Email</label>
                        <input type="text" name="email" id="newUserEmail" class="email required" />
                    </div>
                    <div class="groups">
                        <h3>Group membership</h3>
                        <p>Please select a group and an organisation to make this user a member of</p>
                        <input type="text" class="required" autocomplete="off" name="orgId" id="orgId" value="$page.organisation.orgId" />
                        <table id="orgSearchResults">
                            #if( $page.orgSearchResults.isEmpty() ) 
                            <tr>
                                <td>No matching organisations found</td>
                            </tr>
                            #else
                            #foreach($org in $page.orgSearchResults)
                            <tr>
                                <td><a href="$org.orgId">$org.orgId</a></td>
                                <td><a href="$org.orgId">$!org.title</a></td>
                            </tr>
                            #end
                            #end
                        </table>                

                        <ul>
                            #foreach($group in $groups)
                            #set($id = "radGroup_" + $group.name)
                            <li>
                                $formatter.radio($id, "group", false, $group.name)
                                <label for="$id">$group.name</label>
                            </li>
                            #end
                        </ul>
                    </div>


                    <button type="submit" class="Btn" style="float: right">Save</button>
                </form>

                #end
            </div>
        </div>

        <script type="text/javascript" >
            jQuery(function() {
                initManageUsers();                
            });            
        </script>        
    </body>
</html>