<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Locking resources</title>
<link rel="template" href="learner/modulePage" /><script title="order" type="data/parameter">
<![CDATA[
3
]]>
</script>
  </head>

  <body>
    <h1>Locking resources</h1>

    <p>The great thing about locking in the annotations framework is ... you don't do anything!! Thats right, you dont need to implement or annotate anything.</p>

    <p>But there's a couple of things you need to be aware of...</p>

    <h2>Must provide a UniqueId</h2>

    <p>Milton's transparent locking mechanism relies on each resource having a persistent and reliable uniqueID to key locks on. You can do this by having an ID bean property on your domain object:</p>
<pre class="prettyprint">
public Long getId() {
  return id;
}
</pre>

    <p>Or you can annotate a method on the controller:</p>
<pre class="prettyprint">
@UniqueId
public String getProductCode(Product product) {
  return product.getProductCode();
}
</pre>

    <p>&#160;</p>

    <h2>Be Aware of Clustering</h2>

    <p>Milton's locking implementation uses an in-memory cache of lock tokens. If you deploy to a cluster you need to ensure this is replicated among your servers. At the time of writing milton doesnt have a built-in clustering solution, but one will be ready shortly. Please get in touch if you need help.</p>
  </body>
</html>
